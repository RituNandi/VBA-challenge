Sub stocks()'loop thru all sheets    For Each ws In Worksheets                'declaring variables        Dim Summary_Table_Row As Integer        Dim qtrly_change As Double        Dim qtrly_open As Double        Dim qtrly_close As Double        Dim qtrly_percentage_change As Double        Dim Total_Stock_Volume As Double                'Setting up variables to calculate max increase, decrease and total volume        Dim max_increase As Double        Dim max_decrease As Double        Dim max_total_volume As Double                'Setting up the first row of data for summary table        Summary_Table_Row = 2                'initialize/store first open price value for first ticker        qtrly_open = ws.Cells(2, 3).Value                'finding last row of data        LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row                For i = 2 To LastRow            If ws.Cells(i, 1).Value <> ws.Cells(i + 1, 1).Value Then                'If ticker changes then add up volume and store closing price                Total_Stock_Volume = Total_Stock_Volume + ws.Cells(i, 7).Value                               qtrly_close = ws.Cells(i, 6).Value                                'set values for summary table                ws.Cells(Summary_Table_Row, 12).Value = Total_Stock_Volume                ws.Cells(Summary_Table_Row, 9).Value = ws.Cells(i, 1).Value                            ws.Cells(Summary_Table_Row, 10).Value = (qtrly_close - qtrly_open)                                'insert formatting                ws.Cells(Summary_Table_Row, 10).NumberFormat = "0.00"                                'conditional cell coloring for quarterly change                If ws.Cells(Summary_Table_Row, 10).Value < 0 Then                    ws.Cells(Summary_Table_Row, 10).Interior.ColorIndex = 3                 ElseIf ws.Cells(Summary_Table_Row, 10).Value > 0 Then                    ws.Cells(Summary_Table_Row, 10).Interior.ColorIndex = 4                 Else                    ws.Cells(Summary_Table_Row, 10).Interior.ColorIndex = none                 End If                                'calculate percetage change and round up                'ws.Cells(Summary_Table_Row, 11).Value = "%" & Application.WorksheetFunction.Round(((qtrly_close - qtrly_open) / qtrly_open * 100), 2)                ws.Cells(Summary_Table_Row, 11).Value = Application.WorksheetFunction.Round(((qtrly_close - qtrly_open) / qtrly_open), 4)                                'insert formatting                ws.Cells(Summary_Table_Row, 11).NumberFormat = "0.00%"                                'conditional cell coloring for percentage change                If ws.Cells(Summary_Table_Row, 11).Value < 0 Then                    ws.Cells(Summary_Table_Row, 11).Interior.ColorIndex = 3                 ElseIf ws.Cells(Summary_Table_Row, 11).Value > 0 Then                    ws.Cells(Summary_Table_Row, 11).Interior.ColorIndex = 4                 Else                    ws.Cells(Summary_Table_Row, 11).Interior.ColorIndex = none                 End If                                                             'initialize total volume and closing price                Total_Stock_Volume = 0                qtrly_close = 0                                'store opening price for next ticker                qtrly_open = ws.Cells(i + 1, 3).Value                                'increment summary table counter                Summary_Table_Row = Summary_Table_Row + 1            Else                'if same ticker then add to total volume and store closing price                Total_Stock_Volume = Total_Stock_Volume + ws.Cells(i, 7).Value                qtrly_close = ws.Cells(i, 6).Value            End If        Next i                    'find out the last row of data for summary table        LastRowTicker = ws.Cells(Rows.Count, 9).End(xlUp).Row        'MsgBox (LastRowTicker)                'find max percentage increase               'setting up the first row value as the initial value        If LastRowTicker <= 1 Then            max_increase = 0         Else            max_increase = ws.Range("K2").Value         End If         For i = 2 To LastRowTicker                      ' if next row value is greater, then set that as new max value and store the corresponding ticker           If ws.Cells(i, 11).Value > max_increase Then               max_increase = ws.Cells(i, 11).Value               Tag = ws.Cells(i, 9).Value           End If                   Next i        'print max increase percentage and corresponding ticker        ws.Cells(2, 16).Value = Tag        ws.Cells(2, 17).Value = "%" & (max_increase * 100)         'find max percentage decrease        If LastRowTicker <= 1 Then           max_decrease = 0        Else           max_decrease = ws.Range("K2").Value        End If                For i = 2 To LastRowTicker           If ws.Cells(i, 11).Value < max_decrease Then               max_decrease = ws.Cells(i, 11).Value               Tag = ws.Cells(i, 9).Value           End If                   Next i        ws.Cells(3, 16).Value = Tag        ws.Cells(3, 17).Value = "%" & (max_decrease * 100)         'find max total volume        If LastRowTicker <= 1 Then           max_total_volume = 0        Else           max_total_volume = ws.Range("L2").Value        End If                For i = 2 To LastRowTicker           If ws.Cells(i, 12).Value > max_total_volume Then               max_total_volume = ws.Cells(i, 12).Value               Tag = ws.Cells(i, 9).Value           End If                   Next i        ws.Cells(4, 16).Value = Tag        ws.Cells(4, 17).Value = max_total_volume           'setting the header for summary table        ws.Cells(1, 9).Value = "Ticker"        ws.Cells(1, 10).Value = "Quarterly Change"        ws.Cells(1, 11).Value = "Percent Change"        ws.Cells(1, 12).Value = "Total Stock Volume"        ws.Cells(1, 16).Value = "Ticker"        ws.Cells(1, 17).Value = "Value"        ws.Cells(2, 15).Value = "Greatest % Increase"        ws.Cells(3, 15).Value = "Greatest % Decrease"        ws.Cells(4, 15).Value = "Greatest Total volume"                'autofit all columns        ws.Columns("A:Q").AutoFit    Next ws    MsgBox ("Outputs for All Quarters Complete")End Sub